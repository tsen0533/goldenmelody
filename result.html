<script>
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxK7iWtoFUPUvCgNdZ5XCDjh4dbEWRTNg3G9iX0RciqIenKfOrnENeEi35ooTIurrKF/exec";

function getScoreFromUrl() {
  const params = new URLSearchParams(window.location.search);
  return parseInt(params.get('score'), 10) || 0;
}
const score = getScoreFromUrl();

// 1. å–å¾—æš±ç¨±ï¼ˆå¯é¸ï¼‰
const userName = prompt("è«‹è¼¸å…¥ä½ çš„æš±ç¨±ï¼ˆå¯ç•™ç©ºï¼‰") || "";

// 2. å–å¾—ç­”æ¡ˆ
const userAnswers = JSON.parse(localStorage.getItem("goldenmelody-answers")) || [];

// 3. é€å‡ºè³‡æ–™
function submitResultToSheet(name, score, answers) {
  fetch(GOOGLE_SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      name: name,
      score: score,
      answers: answers
    }),
    headers: {
      "Content-Type": "application/json"
    }
  }).then(r => r.json())
    .then(res => {
      console.log("å·²é€å‡º", res);
    });
}
submitResultToSheet(userName, score, userAnswers);

// ä¸‹é¢æ˜¯é¡¯ç¤ºåœ–ç‰‡çš„éƒ¨åˆ†
const resultText = document.getElementById("resultText");
const resultImage = document.getElementById("resultImage");

if (score <= 2) {
  resultText.innerText = `ğŸ¥² çŒœä¸é€çš„ä¸åªæ˜¯ä»–çš„å¿ƒï¼Œé‚„æœ‰é¡Œç›®ï¼ˆå¾—åˆ†ï¼š${score}/9ï¼‰`;
  resultImage.src = "IMG_1797.JPG";
} else if (score <= 6) {
  resultText.innerText = `ğŸ¤” ççŒœå¾®æ‡‚ï¼Œå¤šå¤šåŠ æ²¹ï¼ï¼ˆå¾—åˆ†ï¼š${score}/9ï¼‰`;
  resultImage.src = "IMG_1795.JPG";
} else {
  resultText.innerText = `ğŸ‰ æ‡‚å“¥å‡ºæ‰‹äº†ï¼ï¼ï¼ˆå¾—åˆ†ï¼š${score}/9ï¼‰`;
  resultImage.src = "IMG_1796.JPG";
}
</script>
